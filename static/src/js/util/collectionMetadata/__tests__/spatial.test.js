import { getCollectionGeoFeatures } from '../spatial'

describe('getCollectionGeoFeatures', () => {
  test('returns the collection of geo features based on the collection metadata', () => {
    const metadata = {
      boxes: [
        '-6.17041 -18.28125 32.62583 60'
      ],
      coordinateSystem: 'CARTESIAN',
      lines: [
        '-14.07 -0.37 1.27 4.75',
        '44.9778 -93.265 47.6062 -122.3321'
      ],
      points: null,
      gibsLayers: 'None',
      spatial: [
        'Bounding Rectangle: (32.62583°, -18.28125°, -6.17041°, 60.0°)\n',
        'Line: ((-14.07°, -0.37°), (1.27°, 4.75°))\n',
        'Line: ((44.9778°, -93.265°), (47.6062°, -122.3321°))\n'
      ]
    }
    const response = getCollectionGeoFeatures(metadata)
    expect(response).toEqual([
      {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiPolygon',
          coordinates: [
            [
              [
                [-18.28125, -6.17041],
                [-15.8349609375, -6.17041],
                [-13.388671875, -6.17041],
                [-10.9423828125, -6.17041],
                [-8.49609375, -6.17041],
                [-6.0498046875, -6.17041],
                [-3.603515625, -6.17041],
                [-1.1572265625, -6.17041],
                [1.2890625, -6.17041],
                [3.7353515625, -6.17041],
                [6.181640625, -6.17041],
                [8.6279296875, -6.17041],
                [11.07421875, -6.17041],
                [13.5205078125, -6.17041],
                [15.966796875, -6.17041],
                [18.4130859375, -6.17041],
                [20.859375, -6.17041],
                [23.3056640625, -6.17041],
                [25.751953125, -6.17041],
                [28.1982421875, -6.17041],
                [30.64453125, -6.17041],
                [33.0908203125, -6.17041],
                [35.537109375, -6.17041],
                [37.9833984375, -6.17041],
                [40.4296875, -6.17041],
                [42.8759765625, -6.17041],
                [45.322265625, -6.17041],
                [47.7685546875, -6.17041],
                [50.21484375, -6.17041],
                [52.6611328125, -6.17041],
                [55.107421875, -6.17041],
                [57.5537109375, -6.17041],
                [60, -6.17041],
                [60, -3.7456450000000006],
                [60, -1.3208800000000003],
                [60, 1.1038849999999998],
                [60, 3.52865],
                [60, 5.953415],
                [60, 8.37818],
                [60, 10.802945000000001],
                [60, 13.22771],
                [60, 15.652474999999999],
                [60, 18.07724],
                [60, 20.502005],
                [60, 22.92677],
                [60, 25.351535],
                [60, 27.7763],
                [60, 30.201065],
                [60, 32.62583],
                [57.5537109375, 32.62583],
                [55.107421875, 32.62583],
                [52.6611328125, 32.62583],
                [50.21484375, 32.62583],
                [47.7685546875, 32.62583],
                [45.322265625, 32.62583],
                [42.8759765625, 32.62583],
                [40.4296875, 32.62583],
                [37.9833984375, 32.62583],
                [35.537109375, 32.62583],
                [33.0908203125, 32.62583],
                [30.64453125, 32.62583],
                [28.1982421875, 32.62583],
                [25.751953125, 32.62583],
                [23.3056640625, 32.62583],
                [20.859375, 32.62583],
                [18.4130859375, 32.62583],
                [15.966796875, 32.62583],
                [13.5205078125, 32.62583],
                [11.07421875, 32.62583],
                [8.6279296875, 32.62583],
                [6.181640625, 32.62583],
                [3.7353515625, 32.62583],
                [1.2890625, 32.62583],
                [-1.1572265625, 32.62583],
                [-3.603515625, 32.62583],
                [-6.0498046875, 32.62583],
                [-8.49609375, 32.62583],
                [-10.9423828125, 32.62583],
                [-13.388671875, 32.62583],
                [-15.8349609375, 32.62583],
                [-18.28125, 32.62583],
                [-18.28125, 30.201065],
                [-18.28125, 27.7763],
                [-18.28125, 25.351535],
                [-18.28125, 22.92677],
                [-18.28125, 20.502005],
                [-18.28125, 18.07724],
                [-18.28125, 15.652474999999999],
                [-18.28125, 13.22771],
                [-18.28125, 10.802945000000001],
                [-18.28125, 8.37818],
                [-18.28125, 5.953415],
                [-18.28125, 3.52865],
                [-18.28125, 1.1038849999999998],
                [-18.28125, -1.3208800000000003],
                [-18.28125, -3.7456450000000006],
                [-18.28125, -6.17041]
              ]
            ]
          ]
        }
      },
      {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'MultiLineString',
          coordinates: [
            [[-0.37, -14.07], [4.75, 1.27]],
            [[-93.265, 44.9778], [-122.3321, 47.6062]]
          ]
        }
      }
    ])

    // Bounding box and a 2 lines
    expect(response.length).toEqual(2)
  })
})
